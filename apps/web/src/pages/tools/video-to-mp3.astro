---
/**
 * Video to MP3 - AI-Native Tool Page
 *
 * Optimized for LLM extraction with:
 * - TL;DR answer box (50-70 words)
 * - Semantic Q&A sections
 * - Full schema markup (SoftwareApplication, HowTo, FAQPage)
 */
import Layout from '../../layouts/Layout.astro';
import TrustBar from '../../components/ui/TrustBar.astro';
import Navbar from '../../components/ui/Navbar.astro';
import Footer from '../../components/ui/Footer.astro';
import AnswerBox from '../../components/seo/AnswerBox.astro';
import QASections from '../../components/seo/QASections.astro';
import RelatedTools from '../../components/seo/RelatedTools.astro';
import { getToolById } from '../../lib/tools';
import SchemaMarkup from '../../components/seo/SchemaMarkup.astro';
import VideoToMp3 from '../../components/tools/VideoToMp3';

// Get tool data from Single Source of Truth (tools.ts)
const toolData = getToolById('video-to-mp3');
if (!toolData) throw new Error('Tool not found: video-to-mp3');

// Tool metadata derived from registry
const tool = {
  id: toolData.id,
  name: toolData.name,
  category: toolData.category,
  url: toolData.href
};

// AI-optimized content - SEO from tools.ts, extended content page-specific
const seoContent = {
  // Page meta from Single Source of Truth
  title: toolData.seo?.title || `${toolData.name} - Free Online Tool | New Life Solutions`,
  description: toolData.seo?.metaDescription || toolData.description,

  // TL;DR Answer Box (50-70 words - this is what AI extracts)
  answerBox: {
    title: toolData.seo?.h1 || 'Summarize Text & Documents with AI',
    queryTarget: toolData.seo?.keywords?.[0] || 'How to Summarize Documents Online Free',
    tldr: toolData.answer || `Paste text, upload a PDF/DOCX/TXT file, or enter a URL to generate an instant summary. Choose from brief, standard, or detailed lengths. Select bullet points, paragraphs, or key takeaways format. Use extractive mode for 100% local processing, or connect your own OpenAI/Claude API key for AI-powered summaries. Free, private, no signup required.`,
    trustSignals: [
      'FFmpeg in browser',
      'No server upload',
      'Select MP3 bitrate',
      'Works offline'
    ]
  },

  // Q&A Sections
  qa: {
    whatIs: {
      answer: `Video to MP3 is a free browser-based tool that extracts audio from video files and converts it to high-quality MP3 format. Powered by FFmpeg compiled to WebAssembly, it processes videos entirely on your device without uploading anything to servers.`,
      context: `Perfect for extracting music from videos, saving podcast audio, or creating audio versions of video content.`
    },
    howItWorks: {
      steps: [
        'Drag and drop a video file or click to browse your files',
        'Select your preferred MP3 bitrate (128kbps, 192kbps, 256kbps, or 320kbps)',
        'Click "Extract Audio" to begin conversion',
        'Wait for FFmpeg to process the video (first use loads the library)',
        'Download your MP3 file instantly'
      ]
    },
    whyBrowserBased: {
      benefits: [
        'Privacy first: Video files never leave your device or get uploaded anywhere',
        'Full quality: Extract audio at up to 320kbps without server compression',
        'No limits: Convert as many videos as you want with no daily quotas',
        'Offline capable: Works without internet after first page load',
        'Fast: No upload wait time—processing starts immediately'
      ]
    },
    faqs: [
      {
        question: 'What video formats are supported?',
        answer: `Most common video formats are supported including MP4, WebM, MOV, AVI, MKV, and more. FFmpeg handles the conversion internally regardless of the source format.`
      },
      {
        question: 'Is the audio quality preserved?',
        answer: `Yes. You can select bitrates up to 320kbps for near-lossless quality. The output quality depends on the original video's audio track—we don't add any additional compression beyond your selected bitrate.`
      },
      {
        question: 'Why does the first conversion take longer?',
        answer: `The first time you use the tool, it downloads the FFmpeg WebAssembly library (~30MB). This is cached by your browser, so subsequent conversions start instantly.`
      },
      {
        question: 'Is there a file size limit?',
        answer: `There's no enforced limit, but very large videos (500MB+) may be slower depending on your device's memory and processing power. For best results, keep files under 200MB.`
      },
      {
        question: 'Does this work on mobile devices?',
        answer: `Yes, but performance varies by device. Modern smartphones with sufficient memory can process videos, though desktop browsers typically offer better performance for large files.`
      }
    ]
  }
};

// Schema data
const schemaData = {
  toolId: tool.id,
  toolName: tool.name,
  description: seoContent.description,
  category: tool.category,
  steps: seoContent.qa.howItWorks.steps,
  faqs: seoContent.qa.faqs,
  url: tool.url
};
---

<Layout
  title={seoContent.title}
  description={seoContent.description}
  image="/thumbnails/video-to-mp3.svg"
>
  <!-- Schema Markup for AI extraction -->
  <SchemaMarkup {...schemaData} />

  <Navbar />

  <main class="pt-20 pb-16 px-6 min-h-screen">
    <div class="max-w-3xl mx-auto">

      <!-- Answer Box: AI extracts this first -->
      <AnswerBox
        title={seoContent.answerBox.title}
        tldr={seoContent.answerBox.tldr}
        toolName={tool.name}
        queryTarget={seoContent.answerBox.queryTarget}
        trustSignals={seoContent.answerBox.trustSignals}
      />

      <!-- Tool Component -->
      <section class="tool-section" aria-label="Video to MP3 Tool">
        <VideoToMp3 client:load />
        <TrustBar signals={seoContent.answerBox.trustSignals} />
      </section>

      <!-- Q&A Sections: Semantic structure for AI -->
      <QASections
        toolName={tool.name}
        whatIs={seoContent.qa.whatIs}
        howItWorks={seoContent.qa.howItWorks}
        whyBrowserBased={seoContent.qa.whyBrowserBased}
        faqs={seoContent.qa.faqs}
        stats={toolData?.stats}
      />

      <!-- Related Tools -->
      <RelatedTools currentToolId="video-to-mp3" />

    </div>
  </main>

  <Footer />
</Layout>

<style>
  .tool-section {
    margin: 2rem 0;
  }
</style>
