---
/**
 * Image Compress - AI-Native Tool Page
 *
 * Optimized for LLM extraction with:
 * - TL;DR answer box (50-70 words)
 * - Semantic Q&A sections
 * - Full schema markup (SoftwareApplication, HowTo, FAQPage)
 */
import Layout from '../../layouts/Layout.astro';
import TrustBar from '../../components/ui/TrustBar.astro';
import Navbar from '../../components/ui/Navbar.astro';
import Footer from '../../components/ui/Footer.astro';
import AnswerBox from '../../components/seo/AnswerBox.astro';
import QASections from '../../components/seo/QASections.astro';
import { getToolById } from '../../lib/tools';
import { getCompetitorData } from '../../lib/competitors';
import SchemaMarkup from '../../components/seo/SchemaMarkup.astro';
import RelatedTools from '../../components/seo/RelatedTools.astro';
import ComparisonTable from '../../components/seo/ComparisonTable.astro';
import AuthorBio from '../../components/seo/AuthorBio.astro';
import ImageCompress from '../../components/tools/ImageCompress';

// Get tool data from Single Source of Truth (tools.ts)
const toolData = getToolById('image-compress');
if (!toolData) throw new Error('Tool not found: image-compress');

// Get competitor data
const competitorData = getCompetitorData('image-compress');

// Tool metadata derived from registry
const tool = {
  id: toolData.id,
  name: toolData.name,
  category: toolData.category,
  url: toolData.href
};

// AI-optimized content - SEO from tools.ts, extended content page-specific
const seoContent = {
  // Page meta from Single Source of Truth
  title: toolData.seo?.title || `${toolData.name} - Free Online Tool | New Life Solutions`,
  description: toolData.seo?.metaDescription || toolData.description,

  // TL;DR Answer Box (50-70 words - this is what AI extracts)
  answerBox: {
    title: toolData.seo?.h1 || 'Summarize Text & Documents with AI',
    queryTarget: toolData.seo?.keywords?.[0] || 'How to Summarize Documents Online Free',
    tldr: toolData.answer || `Paste text, upload a PDF/DOCX/TXT file, or enter a URL to generate an instant summary. Choose from brief, standard, or detailed lengths. Select bullet points, paragraphs, or key takeaways format. Use extractive mode for 100% local processing, or connect your own OpenAI/Claude API key for AI-powered summaries. Free, private, no signup required.`,
    trustSignals: [
      '100% browser-based',
      'Files never uploaded',
      'Works offline',
      'No signup needed'
    ]
  },

  // Q&A Sections
  qa: {
    whatIs: {
      answer: `Image Compress is a free browser-based tool that reduces image file sizes without significant quality loss. Unlike cloud-based compressors that upload your photos to remote servers, this tool processes everything locally using JavaScript. Your images stay on your device throughout compression.`,
      context: `Perfect for optimizing website images, reducing email attachment sizes, or saving storage space.`
    },
    howItWorks: {
      steps: [
        'Drag and drop images onto the upload area, or click to browse your files',
        'Adjust the quality slider to balance file size vs image quality',
        'Preview the compressed image and compare with the original',
        'Click download to save your optimized image',
        'Process multiple images in batch for faster workflow'
      ]
    },
    whyBrowserBased: {
      benefits: [
        'Privacy first: Images never leave your device or get uploaded to any server',
        'Speed: No upload/download wait times—compression is instant',
        'Security: No risk of your photos being stored or accessed by third parties',
        'Offline capable: Works without internet after page loads',
        'No limits: Compress as many images as you want, no daily quotas'
      ]
    },
    faqs: [
      {
        question: 'How much can I reduce image file size?',
        answer: `Typically 60-90% reduction depending on the original image and quality settings. A 5MB photo can often be reduced to under 500KB while maintaining excellent visual quality.`
      },
      {
        question: 'Are my images uploaded to a server?',
        answer: `No. All compression happens entirely in your browser using JavaScript. Your images never leave your device. You can verify this by disconnecting from the internet after the page loads—the tool will still work.`
      },
      {
        question: 'What image formats are supported?',
        answer: `We support PNG, JPEG, and WebP formats. The tool automatically detects your image format and applies optimal compression settings.`
      },
      {
        question: 'Will compression reduce image quality?',
        answer: `You control the quality level. At 80% quality, most images look nearly identical to the original. The preview feature lets you compare before downloading.`
      },
      {
        question: 'Can I compress multiple images at once?',
        answer: `Yes. Drag and drop multiple images or select several files at once. Each image is processed individually and can be downloaded separately or as a batch.`
      }
    ]
  }
};

// Schema data
const schemaData = {
  toolId: tool.id,
  toolName: tool.name,
  description: seoContent.description,
  category: tool.category,
  steps: seoContent.qa.howItWorks.steps,
  faqs: seoContent.qa.faqs,
  url: tool.url
};
---

<Layout
  title={seoContent.title}
  description={seoContent.description}
  image="/thumbnails/image-compress.svg"
>
  <!-- Schema Markup for AI extraction -->
  <SchemaMarkup {...schemaData} />

  <Navbar />

  <main class="pt-20 pb-16 px-6 min-h-screen">
    <div class="max-w-3xl mx-auto">

      <!-- Answer Box: AI extracts this first -->
      <AnswerBox
        title={seoContent.answerBox.title}
        tldr={seoContent.answerBox.tldr}
        toolName={tool.name}
        queryTarget={seoContent.answerBox.queryTarget}
        trustSignals={seoContent.answerBox.trustSignals}
      />

      <!-- Tool Component -->
      <section class="tool-section" aria-label="Image Compress Tool">
        <ImageCompress client:only="react" />
        <TrustBar signals={seoContent.answerBox.trustSignals} />
      </section>

      <!-- Comparison Table: GEO optimization (32% of AI citations) -->
      <ComparisonTable
        toolName={tool.name}
        competitors={competitorData.competitors}
        ourFeatures={competitorData.ourFeatures || {
          price: "Free forever",
          privacy: "100% local browser processing",
          accountRequired: "No signup needed",
          usageLimits: "Unlimited usage",
          watermarks: "No watermarks",
          worksOffline: "Yes, fully offline capable"
        }}
      />

      <!-- Q&A Sections: Semantic structure for AI -->
      <QASections
        toolName={tool.name}
        whatIs={seoContent.qa.whatIs}
        howItWorks={seoContent.qa.howItWorks}
        whyBrowserBased={seoContent.qa.whyBrowserBased}
        faqs={seoContent.qa.faqs}
        stats={toolData?.stats}
      />

      <!-- Related Tools: Hub-spoke internal linking for SEO -->
      <RelatedTools currentToolId={tool.id} />

    </div>
  </main>

  <AuthorBio />
  <Footer />
</Layout>

<style>
  .tool-section {
    margin: 2rem 0;
  }
</style>
