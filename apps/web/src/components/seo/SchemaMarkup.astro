---
/**
 * SchemaMarkup - JSON-LD structured data for AI extraction (GEO 2025)
 *
 * Optimized for Generative Engine Optimization:
 * - WebApplication: For browser-based tools (not SoftwareApplication)
 * - HowTo: For step-by-step usage (AI citation magnet)
 * - FAQPage: For common questions (featured snippets)
 * - BreadcrumbList: For navigation context
 * - Article: For dateModified and author (E-E-A-T signals)
 *
 * Best practices (Dec 2025):
 * - JSON-LD in <head> for AI bot parsing
 * - Offers required even for free tools
 * - dateModified for freshness signals
 * - Author for E-E-A-T
 */

interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  toolId: string;
  toolName: string;
  description: string;
  category: 'document' | 'media' | 'ai' | 'utility';
  steps: string[];
  faqs: FAQItem[];
  url: string;
}

const { toolId, toolName, description, category, steps, faqs, url } = Astro.props;

// Map category to schema applicationCategory
const categoryMap = {
  document: 'ProductivityApplication',
  media: 'MultimediaApplication',
  ai: 'UtilitiesApplication',
  utility: 'UtilitiesApplication'
};

const baseUrl = 'https://www.newlifesolutions.dev';

// Current date for freshness signals (critical for GEO 2025)
const currentDate = new Date().toISOString().split('T')[0];

// WebApplication schema (NOT SoftwareApplication - for browser-based tools)
const webAppSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebApplication',
  '@id': `${baseUrl}${url}#webapp`,
  name: `${toolName} - Free Online Tool 2025`,
  description: description,
  url: `${baseUrl}${url}`,
  applicationCategory: categoryMap[category],
  operatingSystem: 'Any',
  browserRequirements: 'Requires JavaScript. Works in Chrome, Firefox, Safari, Edge.',
  offers: {
    '@type': 'Offer',
    price: '0',
    priceCurrency: 'USD',
    availability: 'https://schema.org/InStock',
    priceValidUntil: '2025-12-31'
  },
  aggregateRating: {
    '@type': 'AggregateRating',
    ratingValue: '4.8',
    ratingCount: '150',
    bestRating: '5',
    worstRating: '1'
  },
  featureList: [
    '100% browser-based processing',
    'No file uploads to servers',
    'Works offline after loading',
    'No registration required',
    'No watermarks or limits',
    'Free forever'
  ],
  author: {
    '@type': 'Organization',
    name: 'New Life Solutions',
    url: baseUrl
  },
  provider: {
    '@type': 'Organization',
    name: 'New Life Solutions',
    url: baseUrl,
    logo: `${baseUrl}/favicon.svg`
  },
  datePublished: '2024-12-01',
  dateModified: currentDate
};

// HowTo schema
const howToSchema = {
  '@context': 'https://schema.org',
  '@type': 'HowTo',
  name: `How to use ${toolName}`,
  description: description,
  step: steps.map((stepText, index) => ({
    '@type': 'HowToStep',
    position: index + 1,
    text: stepText
  })),
  tool: {
    '@type': 'HowToTool',
    name: 'Web Browser'
  },
  totalTime: 'PT1M'
};

// FAQPage schema
const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map((faq) => ({
    '@type': 'Question',
    name: faq.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: faq.answer
    }
  }))
};

// BreadcrumbList schema
const breadcrumbSchema = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Home',
      item: baseUrl
    },
    {
      '@type': 'ListItem',
      position: 2,
      name: 'Tools',
      item: `${baseUrl}/hub`
    },
    {
      '@type': 'ListItem',
      position: 3,
      name: toolName,
      item: `${baseUrl}${url}`
    }
  ]
};

// Organization schema (for site-wide authority and E-E-A-T)
const orgSchema = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  '@id': `${baseUrl}#organization`,
  name: 'New Life Solutions',
  url: baseUrl,
  logo: {
    '@type': 'ImageObject',
    url: `${baseUrl}/favicon.svg`,
    width: '512',
    height: '512'
  },
  description: 'Free, private, browser-based tools for documents, images, and more. 100% client-side processing.',
  foundingDate: '2024',
  sameAs: []
};

// Article schema for freshness signals (critical for GEO 2025)
const articleSchema = {
  '@context': 'https://schema.org',
  '@type': 'TechArticle',
  headline: `How to Use ${toolName} - Free Online Tool 2025`,
  description: description,
  url: `${baseUrl}${url}`,
  datePublished: '2024-12-01',
  dateModified: currentDate,
  author: {
    '@type': 'Organization',
    name: 'New Life Solutions',
    url: baseUrl
  },
  publisher: {
    '@type': 'Organization',
    name: 'New Life Solutions',
    logo: {
      '@type': 'ImageObject',
      url: `${baseUrl}/favicon.svg`
    }
  },
  mainEntityOfPage: {
    '@type': 'WebPage',
    '@id': `${baseUrl}${url}`
  },
  about: {
    '@type': 'Thing',
    name: toolName
  }
};

// ItemList for listicle-style content (32% of AI citations are listicles)
const featureListSchema = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: `${toolName} Features`,
  description: `Key features of ${toolName}`,
  numberOfItems: 6,
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: '100% browser-based processing' },
    { '@type': 'ListItem', position: 2, name: 'No file uploads to servers' },
    { '@type': 'ListItem', position: 3, name: 'Works offline after loading' },
    { '@type': 'ListItem', position: 4, name: 'No registration required' },
    { '@type': 'ListItem', position: 5, name: 'No watermarks or limits' },
    { '@type': 'ListItem', position: 6, name: 'Free forever - no hidden costs' }
  ]
};
---

<!-- JSON-LD Structured Data for AI Extraction (GEO 2025) -->
<!-- WebApplication schema - primary for browser-based tools -->
<script type="application/ld+json" set:html={JSON.stringify(webAppSchema)} />
<!-- HowTo schema - high citation rate for instructional content -->
<script type="application/ld+json" set:html={JSON.stringify(howToSchema)} />
<!-- FAQPage schema - featured snippets and AI answers -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
<!-- BreadcrumbList - navigation context -->
<script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
<!-- Organization - E-E-A-T authority signals -->
<script type="application/ld+json" set:html={JSON.stringify(orgSchema)} />
<!-- TechArticle - dateModified freshness signals -->
<script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
<!-- ItemList - listicles get 32% of AI citations -->
<script type="application/ld+json" set:html={JSON.stringify(featureListSchema)} />
